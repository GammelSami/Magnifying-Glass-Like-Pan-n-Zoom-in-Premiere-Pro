<!DOCTYPE html>
<!-- This document forms the dockable panel. -->
<html>
	<head>
		<meta charset="utf-8">
		<title>Motion Control Panel</title>
		<link rel="stylesheet" href="css/style.css">
		<script>
			const DEBUG = true;
		</script>
		<script src="./lib/CSInterface.js"></script>
    <!-- USE konva DEVELOPMENT VERSION --><script src="lib/konva.min.js"></script>
		<script src="js/functions.js"></script>
		<script>//call extendscript
			var cs = new CSInterface();
			function run(call) {
				//use the adobe_cep_.evalScript to interpret Javascript into Extendscript
				cs.evalScript('$.' + call, function (cb) {
					alert(cb);
				});
			}
		</script>
	</head>
	<body>
		<div id="stage">Something went wrong. Try to reload the Panel or press F5 for soft reload.</div>
		<button onclick="run('get.callback()');">test</button><br>
		<textarea id="debug" style="width:100%;height:200px;"></textarea>
	</body>
</html>



<script>//refresh on F5
window.addEventListener('keydown', (e) => {
	if (e.code == 'F5') location.reload(); //this only reloads the html, not the jsx
})
</script>



<script>//konva stuff

/********** init conva objects **********/

var stage = new Konva.Stage({
	container: 'stage',
	width: null,
	height: null
});

var layer = new Konva.Layer();
stage.add(layer);

var spotlight = new Konva.Rect({
	draggable: true,
	x: null, //position x
	y: null, //position y
	offsetX: null, //position offset (not rotation anchorpoint)
	offsetY: null,
	width: null, //sequence width
	height: null, //sequence height
	name: 'spotlight',
});
layer.add(spotlight);

fetchSequenceValues();

var tr = new Konva.Transformer({
	keepRatio: true,
	rotationSnaps: [0, 45, 90, 135, 180, 225, 270, 315]
});
layer.add(tr);
tr.attachTo(spotlight);
layer.draw();

//debugtext
if (DEBUG) {
	var text = new Konva.Text({
		x: 5,
		y: 5,
		fill: '#B9B9B9' //textcolor from css
	});
	layer.add(text);
	updateText();
}

</script>



<script src="js/events.js">//add event listeners</script>
